{"version":3,"file":"useWidget.js","names":["useRef","useEffect","useImperativeHandle","useDeepMemo","useWidget","newWidget","config","widgetRef","elementRef","widgetRefInternal","configMemo","current","Element","_widgetRefInternal$cu","destroy","getWidget"],"sources":["../../src/useWidget.ts"],"sourcesContent":["\"use client\";\nimport {\n  useRef,\n  useEffect,\n  useImperativeHandle,\n  RefObject,\n  ComponentRef,\n  ElementType,\n} from \"react\";\n\nimport type { Widget } from \"lisn.js\";\nimport { WidgetComponentRef } from \"./types\";\nimport { useDeepMemo } from \"./useDeepMemo\";\n\nexport const useWidget = <\n  T extends ElementType,\n  W extends Widget,\n  C extends object,\n>(\n  newWidget: (element: Element, config?: C) => W | null,\n  config?: C,\n  widgetRef?: RefObject<WidgetComponentRef<W>>,\n) => {\n  const elementRef = useRef<ComponentRef<T>>(null);\n  const widgetRefInternal = useRef<W>(null);\n  const configMemo = useDeepMemo(config);\n\n  useEffect(() => {\n    if (elementRef.current instanceof Element) {\n      widgetRefInternal.current = newWidget(elementRef.current, configMemo);\n    }\n\n    return () => {\n      widgetRefInternal.current?.destroy();\n    };\n  }, [configMemo, newWidget]);\n\n  useImperativeHandle(widgetRef, () => {\n    return {\n      getWidget: () => widgetRefInternal.current,\n    };\n  });\n\n  return elementRef;\n};\n"],"mappings":"AAAA,YAAY;;AACZ,SACEA,MAAM,EACNC,SAAS,EACTC,mBAAmB,QAId,OAAO;AAId,SAASC,WAAW,QAAQ,eAAe;AAE3C,OAAO,MAAMC,SAAS,GAAGA,CAKvBC,SAAqD,EACrDC,MAAU,EACVC,SAA4C,KACzC;EACH,MAAMC,UAAU,GAAGR,MAAM,CAAkB,IAAI,CAAC;EAChD,MAAMS,iBAAiB,GAAGT,MAAM,CAAI,IAAI,CAAC;EACzC,MAAMU,UAAU,GAAGP,WAAW,CAACG,MAAM,CAAC;EAEtCL,SAAS,CAAC,MAAM;IACd,IAAIO,UAAU,CAACG,OAAO,YAAYC,OAAO,EAAE;MACzCH,iBAAiB,CAACE,OAAO,GAAGN,SAAS,CAACG,UAAU,CAACG,OAAO,EAAED,UAAU,CAAC;IACvE;IAEA,OAAO,MAAM;MAAA,IAAAG,qBAAA;MACX,CAAAA,qBAAA,GAAAJ,iBAAiB,CAACE,OAAO,cAAAE,qBAAA,eAAzBA,qBAAA,CAA2BC,OAAO,CAAC,CAAC;IACtC,CAAC;EACH,CAAC,EAAE,CAACJ,UAAU,EAAEL,SAAS,CAAC,CAAC;EAE3BH,mBAAmB,CAACK,SAAS,EAAE,MAAM;IACnC,OAAO;MACLQ,SAAS,EAAEA,CAAA,KAAMN,iBAAiB,CAACE;IACrC,CAAC;EACH,CAAC,CAAC;EAEF,OAAOH,UAAU;AACnB,CAAC","ignoreList":[]}