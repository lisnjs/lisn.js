{"version":3,"file":"track-scroll.js","names":["MH","validateNumber","ScrollWatcher","Widget","registerWidget","TrackScroll","_Widget","element","config","_this","_classCallCheck","_callSuper","id","DUMMY_ID","reuse","trackScroll","assign","scrollable","onDestroy","noTrackScroll","_inherits","_createClass","key","value","get","instance","_superPropGet","isInstanceOf","register","WIDGET_NAME","configValidator","threshold","debounceWindow"],"sources":["../../../src/ts/widgets/track-scroll.ts"],"sourcesContent":["/**\n * @module Widgets\n */\n\nimport * as MH from \"@lisn/globals/minification-helpers\";\n\nimport { validateNumber } from \"@lisn/utils/validation\";\n\nimport { ScrollWatcher } from \"@lisn/watchers/scroll-watcher\";\n\nimport {\n  Widget,\n  WidgetConfigValidatorObject,\n  registerWidget,\n} from \"@lisn/widgets/widget\";\n\n/**\n * This is a simple wrapper around the {@link ScrollWatcher}. If you are using\n * the JavaScript API, you should use the {@link ScrollWatcher} directly. The\n * purpose of this widget is to expose the watcher's ability to track scroll\n * and set relevant CSS properties via the HTML API. See\n * {@link ScrollWatcher.trackScroll}.\n *\n * -----\n *\n * To use with auto-widgets (HTML API) (see\n * {@link Settings.settings.autoWidgets | settings.autoWidgets}), the following\n * CSS classes or data attributes are recognized:\n * - `lisn-track-scroll` class or `data-lisn-track-scroll` attribute set on\n *   the element that constitutes the widget.\n *\n * @example\n * This will track scroll on this element and set the relevant CSS properties.\n *\n * ```html\n * <div class=\"lisn-track-scroll\"></div>\n * ```\n */\nexport class TrackScroll extends Widget {\n  static get(element: Element): TrackScroll | null {\n    const instance = super.get(element, DUMMY_ID);\n    if (MH.isInstanceOf(instance, TrackScroll)) {\n      return instance;\n    }\n    return null;\n  }\n\n  static register() {\n    registerWidget(\n      WIDGET_NAME,\n      (element, config) => {\n        if (!TrackScroll.get(element)) {\n          return new TrackScroll(element, config);\n        }\n        return null;\n      },\n      configValidator,\n    );\n  }\n\n  constructor(element: Element, config?: TrackScrollConfig) {\n    super(element, { id: DUMMY_ID });\n\n    ScrollWatcher.reuse().trackScroll(\n      null,\n      MH.assign(\n        {\n          scrollable: element,\n        },\n        config,\n      ),\n    );\n\n    this.onDestroy(() => ScrollWatcher.reuse().noTrackScroll(null, element));\n  }\n}\n\n/**\n * @interface\n */\nexport type TrackScrollConfig = {\n  /**\n   * Corresponds to\n   * {@link Watchers/ScrollWatcher.OnScrollOptions.threshold | OnScrollOptions.threshold}.\n   *\n   * @defaultValue undefined // ScrollWatcher default\n   */\n  threshold?: number;\n\n  /**\n   * Corresponds to\n   * {@link Watchers/ScrollWatcher.OnScrollOptions.debounceWindow | OnScrollOptions.debounceWindow}.\n   *\n   * @defaultValue undefined // ScrollWatcher default\n   */\n  debounceWindow?: number;\n};\n\n// --------------------\n\nconst WIDGET_NAME = \"track-scroll\";\n// Only one TrackScroll widget per element is allowed, but Widget requires a\n// non-blank ID.\nconst DUMMY_ID = WIDGET_NAME;\n\nconst configValidator: WidgetConfigValidatorObject<TrackScrollConfig> = {\n  threshold: validateNumber,\n  debounceWindow: validateNumber,\n};\n"],"mappings":";;;;;;;;;;;;;;;;AAAA;AACA;AACA;;AAEA,OAAO,KAAKA,EAAE;AAEd,SAASC,cAAc;AAEvB,SAASC,aAAa;AAEtB,SACEC,MAAM,EAENC,cAAc;;AAGhB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAaC,WAAW,0BAAAC,OAAA;EAsBtB,SAAAD,YAAYE,OAAgB,EAAEC,MAA0B,EAAE;IAAA,IAAAC,KAAA;IAAAC,eAAA,OAAAL,WAAA;IACxDI,KAAA,GAAAE,UAAA,OAAAN,WAAA,GAAME,OAAO,EAAE;MAAEK,EAAE,EAAEC;IAAS,CAAC;IAE/BX,aAAa,CAACY,KAAK,CAAC,CAAC,CAACC,WAAW,CAC/B,IAAI,EACJf,EAAE,CAACgB,MAAM,CACP;MACEC,UAAU,EAAEV;IACd,CAAC,EACDC,MACF,CACF,CAAC;IAEDC,KAAA,CAAKS,SAAS,CAAC;MAAA,OAAMhB,aAAa,CAACY,KAAK,CAAC,CAAC,CAACK,aAAa,CAAC,IAAI,EAAEZ,OAAO,CAAC;IAAA,EAAC;IAAC,OAAAE,KAAA;EAC3E;EAACW,SAAA,CAAAf,WAAA,EAAAC,OAAA;EAAA,OAAAe,YAAA,CAAAhB,WAAA;IAAAiB,GAAA;IAAAC,KAAA,EAnCD,SAAOC,GAAGA,CAACjB,OAAgB,EAAsB;MAC/C,IAAMkB,QAAQ,GAAAC,aAAA,CAAArB,WAAA,mBAAaE,OAAO,EAAEM,QAAQ,EAAC;MAC7C,IAAIb,EAAE,CAAC2B,YAAY,CAACF,QAAQ,EAAEpB,WAAW,CAAC,EAAE;QAC1C,OAAOoB,QAAQ;MACjB;MACA,OAAO,IAAI;IACb;EAAC;IAAAH,GAAA;IAAAC,KAAA,EAED,SAAOK,QAAQA,CAAA,EAAG;MAChBxB,cAAc,CACZyB,WAAW,EACX,UAACtB,OAAO,EAAEC,MAAM,EAAK;QACnB,IAAI,CAACH,WAAW,CAACmB,GAAG,CAACjB,OAAO,CAAC,EAAE;UAC7B,OAAO,IAAIF,WAAW,CAACE,OAAO,EAAEC,MAAM,CAAC;QACzC;QACA,OAAO,IAAI;MACb,CAAC,EACDsB,eACF,CAAC;IACH;EAAC;AAAA,EApB8B3B,MAAM;;AAuCvC;AACA;AACA;;AAmBA;;AAEA,IAAM0B,WAAW,GAAG,cAAc;AAClC;AACA;AACA,IAAMhB,QAAQ,GAAGgB,WAAW;AAE5B,IAAMC,eAA+D,GAAG;EACtEC,SAAS,EAAE9B,cAAc;EACzB+B,cAAc,EAAE/B;AAClB,CAAC","ignoreList":[]}