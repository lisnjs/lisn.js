{"version":3,"file":"dom-alter.cjs","names":["MC","_interopRequireWildcard","require","MH","_settings","_cssAlter","_domOptimize","_domQuery","_log","_text","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","wrapElementNow","element","options","wrapper","createWrapperFor","ignoreMove","from","parentOf","to","replaceWith","append","exports","wrapElement","asyncMutatorFor","wrapChildrenNow","moveChildrenNow","moveElementNow","wrapChildren","replaceElementNow","newElement","replaceElement","swapElementsNow","elementA","elementB","temp","createElement","swapElements","oldParent","newParent","child","childrenOf","moveChildren","_options$to","parentEl","position","remove","moveElement","hideAndRemoveElement","delay","hideElement","getOrAssignID","prefix","domID","id","randId","isAllowedToWrap","settings","contentWrappingAllowed","getData","PREFIX_NO_WRAP","getWrapper","_tagName","tagName","_classNames","classNames","PREFIX_WRAPPER","parent","lengthOf","isHTMLElement","hasTagName","hasAnyClass","getContentWrapper","firstChild","tryWrapNow","_tryWrapNow","tryWrap","tryWrapContentNow","tryWrapContent","unwrapContentNow","parentElement","removeClassesNow","unwrapContent","cloneElement","clone","cloneNode","setBooleanData","prefixName","insertGhostCloneNow","insertBefore","addClassesNow","PREFIX_GHOST","PREFIX_TRANSITION_DISABLE","PREFIX_ANIMATE_DISABLE","_required","_wrapper","_clone","insertGhostClone","target","_options$from","_options$to2","recordsToSkipOnce","getIgnoreMove","_recordsToSkipOnce$ge","clearIgnoreMove","setTimer","deleteKey","insertArrow","direction","tag","arrow","S_ARROW","setDataNow","newMap","isElement","isInlineTag","wrapContent","_ignoreMove","required","_requiredBy","requiredBy","getWrapperFn","wrapFn","allowedToWrap","PREFIX_INLINE_WRAPPER","logWarn"],"sources":["../../../src/ts/utils/dom-alter.ts"],"sourcesContent":["/**\n * @module Utils\n *\n * @categoryDescription DOM: Altering\n * These functions alter the DOM tree, but could lead to forced layout if not\n * scheduled using {@link Utils.waitForMutateTime}.\n *\n * @categoryDescription DOM: Altering (optimized)\n * These functions alter the DOM tree in an optimized way using\n * {@link Utils.waitForMutateTime} and so are asynchronous.\n */\n\nimport * as MC from \"@lisn/globals/minification-constants\";\nimport * as MH from \"@lisn/globals/minification-helpers\";\n\nimport { settings } from \"@lisn/globals/settings\";\n\nimport {\n  hideElement,\n  hasAnyClass,\n  addClassesNow,\n  removeClassesNow,\n  getData,\n  setDataNow,\n  setBooleanData,\n} from \"@lisn/utils/css-alter\";\nimport { asyncMutatorFor } from \"@lisn/utils/dom-optimize\";\nimport { isInlineTag } from \"@lisn/utils/dom-query\";\nimport { logWarn } from \"@lisn/utils/log\";\nimport { randId } from \"@lisn/utils/text\";\n\n/**\n * Wraps the element in the given wrapper, or a newly created element if not given.\n *\n * @param [options.wrapper]\n *              If it's an element, it is used as the wrapper. If it's a string\n *              tag name, then a new element with this tag is created as the\n *              wrapper. If not given, then `div` is used if the element to be\n *              wrapped has an block-display tag, or otherwise `span` (if the\n *              element to be wrapped has an inline tag name).\n * @param [options.ignoreMove]\n *              If true, the DOM watcher instances will ignore the operation of\n *              replacing the element (so as to not trigger relevant callbacks).\n * @returns The wrapper element that was either passed in options or created.\n *\n * @category DOM: Altering\n */\nexport const wrapElementNow = (\n  element: Element,\n  options?: {\n    wrapper?: HTMLElement | keyof HTMLElementTagNameMap;\n    ignoreMove?: boolean;\n  },\n) => {\n  const wrapper = createWrapperFor(element, options?.wrapper);\n\n  if (options?.ignoreMove === true) {\n    ignoreMove(element, {\n      from: MH.parentOf(element),\n      to: wrapper,\n    });\n\n    ignoreMove(wrapper, {\n      to: MH.parentOf(element),\n    });\n  }\n\n  element.replaceWith(wrapper);\n  wrapper.append(element);\n\n  return wrapper;\n};\n\n/**\n * Like {@link wrapElementNow} except it will {@link Utils.waitForMutateTime}.\n *\n * @category DOM: Altering (optimized)\n */\nexport const wrapElement = asyncMutatorFor(wrapElementNow);\n\n/**\n * Wraps the element's children in the given wrapper, or a newly created element\n * if not given.\n *\n * @see {@link wrapElementNow}.\n *\n * @category DOM: Altering\n */\nexport const wrapChildrenNow = (\n  element: Element,\n  options?: {\n    wrapper?: HTMLElement | keyof HTMLElementTagNameMap;\n    ignoreMove?: boolean;\n  },\n) => {\n  const wrapper = createWrapperFor(element, options?.wrapper);\n  const { ignoreMove } = options ?? {};\n\n  moveChildrenNow(element, wrapper, { ignoreMove });\n  moveElementNow(wrapper, {\n    to: element,\n    ignoreMove,\n  });\n\n  return wrapper;\n};\n\n/**\n * Like {@link wrapChildrenNow} except it will {@link Utils.waitForMutateTime}.\n *\n * @category DOM: Altering (optimized)\n */\nexport const wrapChildren = asyncMutatorFor(wrapChildrenNow);\n\n/**\n * Replace an element with another one.\n *\n * @param [options.ignoreMove]\n *              If true, the DOM watcher instances will ignore the operation of\n *              moving the element (so as to not trigger relevant callbacks).\n *\n * @category DOM: Altering\n */\nexport const replaceElementNow = (\n  element: Element,\n  newElement: Element,\n  options?: {\n    ignoreMove?: boolean;\n  },\n) => {\n  if (options?.ignoreMove === true) {\n    ignoreMove(\n      // remove element\n      element,\n      { from: MH.parentOf(element) },\n    );\n\n    ignoreMove(\n      // move newElement to element's current parent\n      newElement,\n      { from: MH.parentOf(newElement), to: MH.parentOf(element) },\n    );\n  }\n\n  element.replaceWith(newElement);\n};\n\n/**\n * Like {@link replaceElementNow} except it will {@link Utils.waitForMutateTime}.\n *\n * @category DOM: Altering (optimized)\n */\nexport const replaceElement = asyncMutatorFor(replaceElementNow);\n\n/**\n * Replace an element with another one.\n *\n * @param [options.ignoreMove]\n *              If true, the DOM watcher instances will ignore the operation of\n *              moving the element (so as to not trigger relevant callbacks).\n *\n * @category DOM: Altering\n */\nexport const swapElementsNow = (\n  elementA: Element,\n  elementB: Element,\n  options?: {\n    ignoreMove?: boolean;\n  },\n) => {\n  const temp = MH.createElement(\"div\");\n  replaceElementNow(elementA, temp, options);\n  replaceElementNow(elementB, elementA, options);\n  replaceElementNow(temp, elementB, options);\n};\n\n/**\n * Like {@link swapElementsNow} except it will {@link Utils.waitForMutateTime}.\n *\n * @category DOM: Altering (optimized)\n */\nexport const swapElements = asyncMutatorFor(swapElementsNow);\n\n// [TODO v2]: moveChildren to accept newParent as options.to\n\n/**\n * Move an element's children to a new element\n *\n * @param [options.ignoreMove]\n *              If true, the DOM watcher instances will ignore the operation of\n *              moving the children (so as to not trigger relevant callbacks).\n *\n * @category DOM: Altering\n */\nexport const moveChildrenNow = (\n  oldParent: Element,\n  newParent: Element,\n  options?: {\n    ignoreMove?: boolean;\n  },\n) => {\n  if (options?.ignoreMove === true) {\n    for (const child of MH.childrenOf(oldParent)) {\n      ignoreMove(child, {\n        from: oldParent,\n        to: newParent,\n      });\n    }\n  }\n\n  newParent.append(...MH.childrenOf(oldParent));\n};\n\n/**\n * Like {@link moveChildrenNow} except it will {@link Utils.waitForMutateTime}.\n *\n * @category DOM: Altering (optimized)\n */\nexport const moveChildren = asyncMutatorFor(moveChildrenNow);\n\n/**\n * Moves an element to a new position.\n *\n * @param [options.to]         The new parent or sibling (depending on\n *                             `options.position`). If not given, the\n *                             element is removed from the DOM.\n * @param [options.position]   - append (default): append to `options.to`\n *                             - prepend: prepend to `options.to`\n *                             - before: insert before `options.to`\n *                             - after: insert after `options.to`\n * @param [options.ignoreMove] If true, the DOM watcher instances will\n *                             ignore the operation of moving the element\n *                             (so as to not trigger relevant callbacks).\n *\n * @category DOM: Altering\n */\nexport const moveElementNow = (\n  element: Element,\n  options?: {\n    to?: Element;\n    position?: \"append\" | \"prepend\" | \"before\" | \"after\";\n    ignoreMove?: boolean;\n  },\n) => {\n  let parentEl = options?.to ?? null;\n  const position = options?.position || \"append\";\n  if (position === \"before\" || position === \"after\") {\n    parentEl = MH.parentOf(options?.to);\n  }\n\n  if (options?.ignoreMove === true) {\n    ignoreMove(element, {\n      from: MH.parentOf(element),\n      to: parentEl,\n    });\n  }\n\n  if (options?.to) {\n    options.to[position](element);\n  } else {\n    MH.remove(element);\n  }\n};\n\n/**\n * Like {@link moveElementNow} except it will {@link Utils.waitForMutateTime}.\n *\n * @category DOM: Altering (optimized)\n */\nexport const moveElement = asyncMutatorFor(moveElementNow);\n\n/**\n * It will {@link hideElement} and then remove it from the DOM.\n *\n * @param [options.ignoreMove]\n *              If true, the DOM watcher instances will ignore the operation of\n *              replacing the element (so as to not trigger relevant callbacks).\n *\n * @category DOM: Altering (optimized)\n */\nexport const hideAndRemoveElement = async (\n  element: Element,\n  delay = 0,\n  options?: {\n    ignoreMove?: boolean;\n  },\n) => {\n  await hideElement(element, delay);\n  moveElementNow(element, options);\n};\n\n/**\n * @ignore\n * @internal\n */\nexport const getOrAssignID = (element: Element, prefix = \"\") => {\n  let domID = element.id;\n  if (!domID) {\n    domID = `${prefix}-${randId()}`;\n    element.id = domID;\n  }\n\n  return domID;\n};\n\n/**\n * @ignore\n * @internal\n *\n * @since v1.2.0\n */\nexport const isAllowedToWrap = (element: Element) =>\n  settings.contentWrappingAllowed === true &&\n  getData(element, MC.PREFIX_NO_WRAP) === null;\n\n/**\n * @ignore\n * @internal\n *\n * @param [options.classNames] Default is [MC.PREFIX_WRAPPER]. Pass `null` to\n *                             disable check.\n *\n * @since v1.2.0\n */\nexport const getWrapper = (\n  element: Element,\n  options?: {\n    _tagName?: keyof HTMLElementTagNameMap;\n    _classNames?: string[] | null;\n  },\n) => {\n  const { _tagName: tagName, _classNames: classNames = [MC.PREFIX_WRAPPER] } =\n    options ?? {};\n  const parent = MH.parentOf(element);\n  if (\n    MH.lengthOf(MH.childrenOf(parent)) === 1 &&\n    MH.isHTMLElement(parent) &&\n    (!tagName || MH.hasTagName(parent, tagName)) &&\n    (!classNames || hasAnyClass(parent, ...classNames))\n  ) {\n    // Already wrapped\n    return parent;\n  }\n\n  return null; // don't check the element itself, only its parent\n};\n\n/**\n * @ignore\n * @internal\n *\n * @param [options.classNames] Default is [MC.PREFIX_WRAPPER]. Pass `null` to\n *                             disable check.\n *\n * @since v1.2.0\n */\nexport const getContentWrapper = (\n  element: Element,\n  options?: {\n    _tagName?: keyof HTMLElementTagNameMap;\n    _classNames?: string[] | null;\n  },\n) => {\n  const { _tagName: tagName, _classNames: classNames = [MC.PREFIX_WRAPPER] } =\n    options ?? {};\n  const firstChild = MH.childrenOf(element)[0];\n  if (\n    MH.lengthOf(MH.childrenOf(element)) === 1 &&\n    MH.isHTMLElement(firstChild) &&\n    (!tagName || MH.hasTagName(firstChild, tagName)) &&\n    (!classNames || hasAnyClass(firstChild, ...classNames))\n  ) {\n    // Already wrapped\n    return firstChild;\n  }\n\n  return null;\n};\n\n/**\n * @ignore\n * @internal\n *\n * @since v1.2.0\n */\nexport const tryWrapNow = <O extends ContentWrappingOptions>(\n  element: Element,\n  options?: O,\n) => _tryWrapNow(element, options);\n\n/**\n * @ignore\n * @internal\n *\n * @since v1.2.0\n */\nexport const tryWrap = asyncMutatorFor(tryWrapNow);\n\n/**\n * @ignore\n * @internal\n *\n * @since v1.2.0\n */\nexport const tryWrapContentNow = <O extends ContentWrappingOptions>(\n  element: Element,\n  options?: O,\n) => _tryWrapNow(element, options, true);\n\n/**\n * @ignore\n * @internal\n *\n * @since v1.2.0\n */\nexport const tryWrapContent = asyncMutatorFor(tryWrapContentNow);\n\n/**\n * @ignore\n * @internal\n *\n * @since v1.2.0\n */\nexport const unwrapContentNow = (wrapper: Element, classNames?: string[]) => {\n  const parent = wrapper.parentElement;\n  if (parent) {\n    moveChildrenNow(wrapper, parent, { ignoreMove: true });\n    moveElementNow(wrapper, { ignoreMove: true });\n    if (classNames) {\n      removeClassesNow(wrapper, ...classNames);\n    }\n  }\n};\n\n/**\n * @ignore\n * @internal\n *\n * @since v1.2.0\n */\nexport const unwrapContent = asyncMutatorFor(unwrapContentNow);\n\n/**\n * @ignore\n * @internal\n */\nexport const cloneElement = <E extends Element>(element: E) => {\n  const clone = element.cloneNode(true) as E;\n  setBooleanData(clone, MH.prefixName(\"clone\"));\n  return clone;\n};\n\n/**\n * Creates a dummy hidden clone that's got animation and transitions disabled\n * and absolute position, wrapped in a wrapper (of size 0) and inserts it just\n * before the `insertBefore` element (or if not given, the original element),\n * so that the hidden clone overlaps the actual element's regular\n * (pre-transformed) position.\n *\n * It clears the ID of the clone.\n *\n * Returns the clone.\n *\n * @ignore\n * @internal\n */\nexport const insertGhostCloneNow = <E extends Element>(\n  element: E,\n  insertBefore: Element | null = null,\n) => {\n  const clone = cloneElement(element);\n  clone.id = \"\";\n\n  addClassesNow(\n    clone,\n    MC.PREFIX_GHOST,\n    MC.PREFIX_TRANSITION_DISABLE,\n    MC.PREFIX_ANIMATE_DISABLE,\n  );\n\n  const wrapper = _tryWrapNow(clone, { _required: true });\n\n  moveElementNow(wrapper, {\n    to: insertBefore ?? element,\n    position: \"before\",\n    ignoreMove: true,\n  });\n\n  return { _wrapper: wrapper, _clone: clone };\n};\n\n/**\n * @ignore\n * @internal\n *\n * Exposed via DOMWatcher\n */\nexport const insertGhostClone = asyncMutatorFor(insertGhostCloneNow);\n\n/**\n * @ignore\n * @internal\n *\n * Exposed via DOMWatcher\n */\nexport const ignoreMove = (\n  target: Element,\n  options: { from?: Element | null; to?: Element | null },\n) =>\n  recordsToSkipOnce.set(target, {\n    from: options.from ?? null,\n    to: options.to ?? null,\n  });\n\n/**\n * @ignore\n * @internal\n */\nexport const getIgnoreMove = (\n  target: Element,\n): { from: Element | null; to: Element | null } | null =>\n  recordsToSkipOnce.get(target) ?? null;\n\n/**\n * @ignore\n * @internal\n */\nexport const clearIgnoreMove = (target: Element) => {\n  // We should not clear the entry the first time the operation is observed\n  // (when we return true here), because there may be multiple DOMWatcher\n  // instances that will observe it and need to query it. Instead do it shortly.\n  MH.setTimer(() => {\n    MH.deleteKey(recordsToSkipOnce, target);\n  }, 100);\n};\n\n/**\n * @ignore\n * @internal\n */\nexport const insertArrow = (\n  target: Element,\n  direction: \"up\" | \"down\" | \"left\" | \"right\",\n  position: \"prepend\" | \"append\" | \"before\" | \"after\" = \"append\",\n  tag = \"span\",\n) => {\n  const arrow = MH.createElement(tag);\n  addClassesNow(arrow, MH.prefixName(MC.S_ARROW));\n  setDataNow(arrow, MH.prefixName(\"direction\"), direction);\n  moveElement(arrow, { to: target, position, ignoreMove: true });\n  return arrow;\n};\n\n// ----------------------------------------\n\ntype ContentWrappingOptions = {\n  _tagName?: keyof HTMLElementTagNameMap;\n  _classNames?: string[]; // if the wrapper has any one of these, it will be re-used\n  _ignoreMove?: boolean; // default is true here\n  _required?: boolean; // if true, will ignore contentWrappingAllowed and data-lisn-no-wrap\n  _requiredBy?: string; // for logging purposes\n};\n\nconst recordsToSkipOnce = MH.newMap<\n  /* target being moved */ Element,\n  { from: Element | null; to: Element | null }\n>();\n\nconst createWrapperFor = (\n  element: Element,\n  wrapper: HTMLElement | keyof HTMLElementTagNameMap | undefined,\n) => {\n  if (MH.isElement(wrapper)) {\n    return wrapper;\n  }\n\n  let tag = wrapper;\n  if (!tag) {\n    if (isInlineTag(MH.tagName(element))) {\n      tag = \"span\";\n    } else {\n      tag = \"div\";\n    }\n  }\n\n  return MH.createElement(tag);\n};\n\nconst _tryWrapNow = <O extends ContentWrappingOptions>(\n  element: Element,\n  options: O | undefined,\n  wrapContent = false, // if true, wrap its children, otherwise given element\n) => {\n  const {\n    _tagName: tagName,\n    _classNames: classNames = [MC.PREFIX_WRAPPER],\n    _ignoreMove: ignoreMove = true,\n    _required: required = false,\n    _requiredBy: requiredBy = \"\",\n  } = options ?? {};\n\n  const getWrapperFn = wrapContent ? getContentWrapper : getWrapper;\n  const wrapFn = wrapContent ? wrapChildrenNow : wrapElementNow;\n  const allowedToWrap = isAllowedToWrap(element);\n\n  let wrapper = getWrapperFn(element, options);\n  if (!wrapper && (required || allowedToWrap)) {\n    wrapper = wrapFn(element, { wrapper: tagName, ignoreMove });\n    if (classNames) {\n      addClassesNow(wrapper, ...classNames);\n    }\n    if (isInlineTag(MH.tagName(wrapper))) {\n      addClassesNow(wrapper, MC.PREFIX_INLINE_WRAPPER);\n    }\n\n    if (!allowedToWrap && requiredBy) {\n      logWarn(\n        `content wrapping is disabled for element but wrapping is required by ${requiredBy}`,\n      );\n    }\n  }\n\n  return wrapper as O extends { _required: true }\n    ? HTMLElement\n    : HTMLElement | null;\n};\n"],"mappings":"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","ignoreList":[]}