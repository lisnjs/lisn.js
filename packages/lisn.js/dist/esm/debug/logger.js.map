{"version":3,"file":"logger.js","names":["MC","MH","settings","randId","Console","Logger","_createClass","_this","config","arguments","length","undefined","_classCallCheck","_defineProperty","myConfig","merge","verbosityLevel","remoteLoggerURL","remoteLoggerOnMobileOnly","debugID","getBooleanURLParam","isMobile","name","myConsole","remoteLoggerConnectTimeout","logPrefix","concat","debugPrefix","getName","getVerbosityLevel","setVerbosityLevel","l","debug1","_len","args","Array","_key","logDebugN","apply","debug2","_len2","_key2","debug3","_len3","_key3","debug4","_len4","_key4","debug5","_len5","_key5","debug6","_len6","_key6","debug7","_len7","_key7","debug8","_len8","_key8","debug9","_len9","_key9","debug10","_len10","_key10","debug","_len11","_key11","log","_len12","_key12","info","_len13","_key13","warn","_len14","_key14","error","_len15","_key15","logAtCreation","logger","level","_len16","_key16","isNumber","unshift","bugError","regex","test","USER_AGENT","value","getURLParameter","toLowerCase","hasDOM","loc","getDoc","location","URLSearchParams","urlParams","search","get","strReplace","RegExp","match","href","decodeURIComponent"],"sources":["../../../src/ts/debug/logger.ts"],"sourcesContent":["/**\n * @module Debugging\n *\n * @categoryDescription Logging\n * {@link Debugging.LocalConsole | LocalConsole} logs to the local browser\n * console. On iOS devices it uses `console.info` for all levels because of a\n * bug in WebKit whereby other log levels don't show in some remote debuggers.\n * Also, iOS console only supports a single argument, so it joins the given\n * arguments as a single string.\n *\n * {@link Debugging.RemoteConsole | RemoteConsole} connects to a remote\n * {@link https://socket.io/ | socket.io} server and logs messages to it.\n *\n * {@link Console} holds a {@link LocalConsole} and optionally a\n * {@link RemoteConsole} and logs to both.\n *\n * {@link Logger} holds a {@link Console} and implements debug at 10 different\n * levels. The maximum logged level is configurable. Also emits a prefix in\n * debug messages that identifies the instance.\n */\n\nimport * as MC from \"@lisn/globals/minification-constants\";\nimport * as MH from \"@lisn/globals/minification-helpers\";\n\nimport { settings } from \"@lisn/globals/settings\";\n\nimport { LogFunction } from \"@lisn/globals/types\";\n\nimport { randId } from \"@lisn/utils/text\";\n\nimport { LoggerInterface, LoggerConfig } from \"@lisn/debug/types\";\nimport { Console } from \"@lisn/debug/console\";\n\n/**\n * Holds a {@link Console} and implements debug at 10 different levels. The\n * maximum logged level is configurable. Also emits a prefix in debug messages\n * that identifies the instance.\n *\n * @category Logging\n */\nexport class Logger implements LoggerInterface {\n  readonly debug: LogFunction;\n  readonly log: LogFunction;\n  readonly info: LogFunction;\n  readonly warn: LogFunction;\n  readonly error: LogFunction;\n  readonly debug1: LogFunction;\n  readonly debug2: LogFunction;\n  readonly debug3: LogFunction;\n  readonly debug4: LogFunction;\n  readonly debug5: LogFunction;\n  readonly debug6: LogFunction;\n  readonly debug7: LogFunction;\n  readonly debug8: LogFunction;\n  readonly debug9: LogFunction;\n  readonly debug10: LogFunction;\n  readonly getName: () => string;\n  readonly getVerbosityLevel: () => number;\n  readonly setVerbosityLevel: (level: number) => void;\n\n  constructor(config: LoggerConfig = {}) {\n    const myConfig = MH.merge(\n      {\n        // set defaults\n        verbosityLevel: settings.verbosityLevel,\n        remoteLoggerURL: settings.remoteLoggerURL,\n        remoteLoggerOnMobileOnly: settings.remoteLoggerOnMobileOnly,\n        debugID: randId(),\n      },\n      config,\n    );\n\n    let remoteLoggerURL = \"\";\n    if (\n      !getBooleanURLParam(\"disableRemoteLog\") &&\n      (myConfig.remoteLoggerOnMobileOnly === false || isMobile())\n    ) {\n      remoteLoggerURL = myConfig.remoteLoggerURL || \"\";\n    }\n\n    const name = myConfig.name || \"\";\n    const myConsole = new Console(\n      remoteLoggerURL,\n      myConfig.remoteLoggerConnectTimeout,\n    );\n    // use setters bellow to validate value\n    let verbosityLevel = 0;\n    const logPrefix = `[LISN${name ? \": \" + name : \"\"}]`;\n    const debugID = myConfig.debugID;\n    const debugPrefix = `[LISN${(name ? \": \" + name : \"\") + (debugID ? \"-\" + debugID : \"\")}]`;\n\n    this.getName = () => name;\n\n    this.getVerbosityLevel = () => verbosityLevel;\n    this.setVerbosityLevel = (l) => {\n      verbosityLevel = l;\n    };\n\n    this.setVerbosityLevel(myConfig.verbosityLevel || 0);\n\n    this.debug1 = (...args) => logDebugN(this, 1, debugPrefix, ...args);\n    this.debug2 = (...args) => logDebugN(this, 2, debugPrefix, ...args);\n    this.debug3 = (...args) => logDebugN(this, 3, debugPrefix, ...args);\n    this.debug4 = (...args) => logDebugN(this, 4, debugPrefix, ...args);\n    this.debug5 = (...args) => logDebugN(this, 5, debugPrefix, ...args);\n    this.debug6 = (...args) => logDebugN(this, 6, debugPrefix, ...args);\n    this.debug7 = (...args) => logDebugN(this, 7, debugPrefix, ...args);\n    this.debug8 = (...args) => logDebugN(this, 8, debugPrefix, ...args);\n    this.debug9 = (...args) => logDebugN(this, 9, debugPrefix, ...args);\n    this.debug10 = (...args) => logDebugN(this, 10, debugPrefix, ...args);\n\n    this.debug = (...args) => myConsole.debug(debugPrefix, ...args);\n    this.log = (...args) => myConsole.log(logPrefix, ...args);\n    this.info = (...args) => myConsole.info(logPrefix, ...args);\n    this.warn = (...args) => myConsole.warn(logPrefix, ...args);\n    this.error = (...args) => {\n      myConsole.error(logPrefix, ...args);\n    };\n\n    // --------------------\n    if (\"logAtCreation\" in myConfig) {\n      this.debug6(\"New logger:\", myConfig.logAtCreation);\n    }\n  }\n}\n\nexport type ErrorMatchList = Array<\n  RegExp | string | { new (): Error } | symbol\n>;\n\n// ----------------------------------------\n\nconst logDebugN = (logger: Logger, level: number, ...args: unknown[]) => {\n  if (!MH.isNumber(level)) {\n    args.unshift(level);\n    level = 1;\n    logger.error(MH.bugError(\"Missing logger.debug level\"));\n  }\n\n  if (logger.getVerbosityLevel() < level) {\n    return;\n  }\n\n  logger.debug(`[DEBUG ${level}]`, ...args);\n};\n\nconst isMobile = () => {\n  const regex =\n    /Mobi|Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i;\n  return regex.test(MC.USER_AGENT);\n};\n\nconst getBooleanURLParam = (name: string) => {\n  const value = getURLParameter(name);\n  return value && (value === \"1\" || MH.toLowerCase(value) === \"true\");\n};\n\nconst getURLParameter = (name: string) => {\n  if (!MH.hasDOM()) {\n    return null;\n  }\n\n  const loc = MH.getDoc().location;\n  if (typeof URLSearchParams !== \"undefined\") {\n    const urlParams = new URLSearchParams(loc.search);\n    return urlParams.get(name);\n  }\n\n  name = MH.strReplace(name, /[[\\]]/g, \"\\\\$&\");\n  const regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\");\n  const match = loc.href.match(regex);\n\n  if (!match) {\n    return null;\n  }\n\n  if (!match[2]) {\n    return \"\";\n  }\n  return decodeURIComponent(MH.strReplace(match[2], /\\+/g, \" \"));\n};\n"],"mappings":"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","ignoreList":[]}