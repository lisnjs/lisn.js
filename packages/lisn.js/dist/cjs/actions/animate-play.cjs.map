{"version":3,"file":"animate-play.cjs","names":["MC","_interopRequireWildcard","require","_animations","_cssAlter","_action","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","_typeof","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","o","Symbol","iterator","constructor","prototype","_classCallCheck","TypeError","_defineProperties","length","enumerable","configurable","writable","_toPropertyKey","key","_createClass","_defineProperty","value","_toPrimitive","toPrimitive","String","Number","AnimatePlay","exports","element","_getMethods","getMethods","_play","_pause","_toggle","animate","PAUSE","undo","S_TOGGLE","register","registerAction","AnimatePause","_getMethods2","PLAY","TOGGLE","action","isInitial","arguments","undefined","iterateAnimations","animation","isPaused","playState","play","pause","resetCssAnimationsNow","hasClass","PREFIX_ANIMATE_PAUSE","removeClassesNow","addClassesNow"],"sources":["../../../src/ts/actions/animate-play.ts"],"sourcesContent":["/**\n * @module Actions\n *\n * @categoryDescription Animation\n * {@link AnimatePlay} and {@link AnimatePause} resume or pause all animations\n * on the given element. They work with CSS or Web Animations.\n *\n * {@link Actions.Animate | Animate} plays or reverses all animations on the\n * given element. It works with CSS or Web Animations.\n */\n\nimport * as MC from \"@lisn/globals/minification-constants\";\n\nimport {\n  iterateAnimations,\n  resetCssAnimationsNow,\n} from \"@lisn/utils/animations\";\nimport {\n  hasClass,\n  addClassesNow,\n  removeClassesNow,\n} from \"@lisn/utils/css-alter\";\n\nimport { Action, registerAction } from \"@lisn/actions/action\";\n\n/**\n * Resumes or pauses all animations on the given element.\n *\n * It works with CSS or Web Animations.\n *\n * **IMPORTANT:** When constructed, it resets and pauses the animations as a\n * form of initialization.\n *\n * -------\n *\n * To use with auto-widgets (HTML API) as part of a trigger specification:\n * - Action name: \"animate-play\".\n * - Accepted string arguments: none\n * - Accepted options: none\n *\n * @example\n * ```html\n * <button id=\"btn\">Play/pause</button>\n * <div data-lisn-on-click=\"@animate-play +target=#btn\"></div>\n * ```\n *\n * @category Animation\n */\nexport class AnimatePlay implements Action {\n  /**\n   * Resumes the animations without resetting them.\n   */\n  readonly do: () => Promise<void>;\n\n  /**\n   * Pauses the animations without resetting them.\n   */\n  readonly undo: () => Promise<void>;\n\n  /**\n   * Resumes the animations if paused, otherwise pauses them.\n   */\n  readonly toggle: () => Promise<void>;\n\n  static register() {\n    registerAction(\"animate-play\", (element) => new AnimatePlay(element));\n  }\n\n  constructor(element: Element) {\n    const { _play, _pause, _toggle } = getMethods(element);\n\n    // initial state is 0% and paused\n    animate(element, PAUSE, true);\n\n    this.do = _play;\n    this.undo = _pause;\n    this[MC.S_TOGGLE] = _toggle;\n  }\n}\n\n/**\n * Pauses or resumes all animations on the given element.\n *\n * It works with CSS or Web Animations.\n *\n * **IMPORTANT:** When constructed, it plays the animations as a form of\n * initialization.\n *\n * -------\n *\n * To use with auto-widgets (HTML API) as part of a trigger specification:\n * - Action name: \"animate-pause\".\n * - Accepted string arguments: none\n * - Accepted options: none\n *\n * @example\n * ```html\n * <button id=\"btn\">Play/pause</button>\n * <div data-lisn-on-click=\"@animate-pause +target=#btn\"></div>\n * ```\n *\n * @category Animation\n */\nexport class AnimatePause implements Action {\n  /**\n   * Pauses the animations without resetting them.\n   */\n  readonly do: () => Promise<void>;\n\n  /**\n   * Resumes the animations without resetting them.\n   */\n  readonly undo: () => Promise<void>;\n\n  /**\n   * Resumes the animations if paused, otherwise pauses them.\n   */\n  readonly toggle: () => Promise<void>;\n\n  static register() {\n    registerAction(\"animate-pause\", (element) => new AnimatePause(element));\n  }\n\n  constructor(element: Element) {\n    const { _play, _pause, _toggle } = getMethods(element);\n\n    // Initial state is playing\n    _play();\n\n    this.do = _pause;\n    this.undo = _play;\n    this[MC.S_TOGGLE] = _toggle;\n  }\n}\n\n// --------------------\n\ntype AnimateAction = typeof PLAY | typeof PAUSE | typeof TOGGLE;\n\nconst PLAY = 0;\nconst PAUSE = 1;\nconst TOGGLE = 2;\n\nconst getMethods = (element: Element) => {\n  return {\n    _play: () => animate(element, PLAY),\n    _pause: () => animate(element, PAUSE),\n    _toggle: () => animate(element, TOGGLE),\n  };\n};\n\nconst animate = (\n  element: Element,\n  action: AnimateAction,\n  isInitial = false,\n) => {\n  return iterateAnimations(\n    element,\n    /* istanbul ignore next */ // jsdom doesn't support Web Animations\n    (animation) => {\n      const isPaused = animation.playState === \"paused\";\n      if (action === PLAY || (isPaused && action === TOGGLE)) {\n        animation.play();\n      } else {\n        animation.pause();\n      }\n    },\n    (element) => {\n      if (isInitial) {\n        resetCssAnimationsNow(element);\n      }\n\n      const isPaused = hasClass(element, MC.PREFIX_ANIMATE_PAUSE);\n      if (action === PLAY || (isPaused && action === TOGGLE)) {\n        removeClassesNow(element, MC.PREFIX_ANIMATE_PAUSE);\n      } else {\n        addClassesNow(element, MC.PREFIX_ANIMATE_PAUSE);\n      }\n    },\n    isInitial,\n  );\n};\n"],"mappings":"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","ignoreList":[]}