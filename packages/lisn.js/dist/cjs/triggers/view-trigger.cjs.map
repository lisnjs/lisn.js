{"version":3,"file":"view-trigger.cjs","names":["MC","_interopRequireWildcard","require","MH","_settings","_cssAlter","_domAlter","_domQuery","_domSearch","_text","_validation","_views","_animate","_animatePlay","_viewWatcher","_trigger","_debug","_interopRequireDefault","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_defineProperty","_toPropertyKey","value","enumerable","configurable","writable","_toPrimitive","Symbol","toPrimitive","TypeError","String","Number","ViewTrigger","Trigger","register","registerTrigger","element","args","actions","config","assign","views","validateStrList","isValidView","newConfigValidator","constructor","_config$rootMargin","logger","debug","Logger","name","formatAsString","getConfig","copyObject","lengthOf","watcher","ViewWatcher","reuse","root","rootMargin","replace","threshold","target","S_AT","oppositeViews","getOppositeViews","setupWatcher","debug6","run","onView","reverse","willAnimate","action","isInstanceOf","Animate","AnimatePlay","setupRepresentative","then","exports","key","_ref","isLiteralString","isValidScrollOffset","waitForReferenceElement","undefined","_ref2","validateString","validateNumList","_MH$classList","allowedToWrap","settings","contentWrappingAllowed","getData","PREFIX_NO_WRAP","classList","parentOf","contains","PREFIX_WRAPPER","wrapElement","ignoreMove","addClasses","isInlineTag","tagName","PREFIX_INLINE_WRAPPER","prev","previousElementSibling","prevChild","childrenOf","hasClass","PREFIX_GHOST","insertGhostClone","_clone"],"sources":["../../../src/ts/triggers/view-trigger.ts"],"sourcesContent":["/**\n * @module Triggers\n *\n * @categoryDescription View\n * {@link ViewTrigger} allows you to run actions when the viewport's scroll\n * position relative to a given target or offset from top/bottom/left/right is\n * one of the matching \"views\" (at/above/below/left/right), and undo those\n * actions when the viewport's \"view\" is not matching.\n */\n\nimport * as MC from \"@lisn/globals/minification-constants\";\nimport * as MH from \"@lisn/globals/minification-helpers\";\n\nimport { settings } from \"@lisn/globals/settings\";\n\nimport { ViewTarget, View, CommaSeparatedStr } from \"@lisn/globals/types\";\n\nimport { hasClass, addClasses, getData } from \"@lisn/utils/css-alter\";\nimport { wrapElement, insertGhostClone } from \"@lisn/utils/dom-alter\";\nimport { isInlineTag } from \"@lisn/utils/dom-query\";\nimport { waitForReferenceElement } from \"@lisn/utils/dom-search\";\nimport { formatAsString } from \"@lisn/utils/text\";\nimport {\n  validateStrList,\n  validateString,\n  validateNumList,\n} from \"@lisn/utils/validation\";\nimport {\n  getOppositeViews,\n  isValidView,\n  isValidScrollOffset,\n} from \"@lisn/utils/views\";\n\nimport { Action } from \"@lisn/actions/action\";\nimport { Animate } from \"@lisn/actions/animate\";\nimport { AnimatePlay } from \"@lisn/actions/animate-play\";\n\nimport { ViewWatcher } from \"@lisn/watchers/view-watcher\";\n\nimport {\n  registerTrigger,\n  Trigger,\n  TriggerConfig,\n} from \"@lisn/triggers/trigger\";\n\nimport { WidgetConfigValidatorFunc } from \"@lisn/widgets/widget\";\n\nimport debug from \"@lisn/debug/debug\";\n\n/**\n * {@link ViewTrigger} allows you to run actions when the viewport's scroll\n * position relative to a given target or offset from top/bottom/left/right is\n * one of the matching \"views\" (at/above/below/left/right), and undo those\n * actions when the viewport's \"view\" is not matching.\n *\n * -------\n *\n * To use with auto-widgets (HTML API), see {@link registerTrigger} for the\n * specification.\n *\n * - Arguments (optional): One or more (comma-separated) {@link View}s.\n *   Default is \"at\".\n * - Additional trigger options:\n *   - `target`: A string element specification for an element (see\n *     {@link Utils.getReferenceElement | getReferenceElement}) or a\n *     {@link Types.ScrollOffset | ScrollOffset}.\n *   - `root`: A string element specification. See\n *     {@link Utils.getReferenceElement | getReferenceElement}.\n *   - `rootMargin`: A string.\n *   - `threshold`: A number or list (comma-separated) of numbers.\n *\n * @example\n * Show the element when it's in the viewport, hide otherwise.\n *\n * ```html\n * <div data-lisn-on-view=\"at @show\"></div>\n * ```\n *\n * @example\n * Same as above. \"views\" is optional and defaults to \"at\".\n *\n * ```html\n * <div data-lisn-on-view=\"@show\"></div>\n * ```\n *\n * @example\n * As above but using a CSS class instead of data attribute:\n *\n * ```html\n * <div class=\"lisn-on-view--@show\"></div>\n * ```\n *\n * @example\n * Show the element 1000ms after the first time it enters the viewport.\n *\n * ```html\n * <div data-lisn-on-view=\"@show +once +delay=1000\"></div>\n * ```\n *\n * @example\n * Add class `seen` the first time the element enters the viewport, and play\n * the animations defined on it 1000ms after each time it enters the viewport,\n * reverse the animations as soon as it goes out of view.\n *\n * ```html\n * <div data-lisn-on-view=\"@add-class=seen +once ;\n *                         @animate +do-delay=1000\"\n * ></div>\n * ```\n *\n * @example\n * Add class `seen` when the viewport is at or below the element (element\n * above viewport), remove it when the viewport is above the element.\n * Element going to the left or right of the viewport will not trigger the\n * action. See {@link getOppositeViews}:\n *\n * ```html\n * <div data-lisn-on-view=\"at,below @add-class=seen\"></div>\n * ```\n *\n * @example\n * Add class `cls` when the viewport is above or to the left the element\n * (element below or to the right of the viewport), remove it when the\n * viewport is either at, below or to the right of the element.\n *\n * ```html\n * <div data-lisn-on-view=\"above,left @add-class=cls\"></div>\n * ```\n *\n * @example\n * Hide the element when the viewport is above the next element with class\n * `section`, show it when the viewport is below or at the target element.\n *\n * ```html\n * <div data-lisn-on-view=\"above @hide +target=next.section\"></div>\n * <div class=\"section\"></div>\n * ```\n *\n * @example\n * As above, but using `data-lisn-ref` attribute instead of class selector.\n *\n * ```html\n * <div data-lisn-on-view=\"above @hide +target=next-section\"></div>\n * <div data-lisn-ref=\"section\"></div>\n * ```\n *\n * @example\n * Open the {@link Widgets.Openable | Openable} widget configured for this\n * element when the viewport is 75% down from the top of the page.\n *\n * ```html\n * <div data-lisn-on-view=\"@open +target=top:75%\"></div>\n * ```\n *\n * @category View\n */\nexport class ViewTrigger extends Trigger {\n  readonly getConfig: () => ViewTriggerConfig;\n\n  static register() {\n    registerTrigger(\n      \"view\",\n      (element, args, actions, config) => {\n        return new ViewTrigger(\n          element,\n          actions,\n          MH.assign(config, {\n            views: validateStrList(\"views\", args, isValidView),\n          } as const),\n        );\n      },\n      newConfigValidator,\n    );\n  }\n\n  /**\n   * If no actions are supplied, nothing is done.\n   *\n   * @throws {@link Errors.LisnUsageError | LisnUsageError}\n   *                If the config is invalid.\n   */\n  constructor(element: Element, actions: Action[], config?: ViewTriggerConfig) {\n    super(element, actions, config);\n\n    const logger = debug\n      ? new debug.Logger({\n          name: `ViewTrigger-${formatAsString(element)}`,\n        })\n      : null;\n\n    this.getConfig = () => MH.copyObject(config || {});\n\n    if (!MH.lengthOf(actions)) {\n      return;\n    }\n\n    const watcher = ViewWatcher.reuse({\n      root: config?.root,\n      rootMargin: config?.rootMargin?.replace(/,/g, \" \"),\n      threshold: config?.threshold,\n    });\n\n    const target = config?.target || element;\n    const views = config?.views || MC.S_AT;\n    const oppositeViews = getOppositeViews(views);\n\n    const setupWatcher = (target: ViewTarget) => {\n      if (!MH.lengthOf(oppositeViews)) {\n        debug: logger?.debug6(\"Trigger can never be reversed, running now\");\n        // The action is never undone\n        this.run();\n      } else {\n        debug: logger?.debug6(\"Setting up trigger\", views, oppositeViews);\n        watcher.onView(target, this.run, { views });\n        watcher.onView(target, this.reverse, { views: oppositeViews });\n      }\n    };\n\n    // See comment in globals/settings under contentWrappingAllowed\n    let willAnimate = false;\n    for (const action of actions) {\n      if (\n        MH.isInstanceOf(action, Animate) ||\n        MH.isInstanceOf(action, AnimatePlay)\n      ) {\n        willAnimate = true;\n        break;\n      }\n    }\n\n    if (willAnimate) {\n      setupRepresentative(element).then(setupWatcher);\n    } else {\n      setupWatcher(target);\n    }\n  }\n}\n\n/**\n * @category View\n * @interface\n */\nexport type ViewTriggerConfig = TriggerConfig & {\n  /**\n   * The {@link View} to use as the trigger.\n   * See also {@link Watchers/ViewWatcher.OnViewOptions | OnViewOptions}\n   *\n   * Actions will be \"done\" when the view matches the given spec and \"undone\"\n   * otherwise. What the opposite views are depends on the given view. E.g. for\n   * \"at\", opposites are all the other ones;  for \"above\", the opposite ones\n   * are \"at\" and \"below\"; for \"at,above\" opposite is \"below\", etc.\n   *\n   * @defaultValue \"at\"\n   */\n  views?: CommaSeparatedStr<View> | View[];\n\n  /**\n   * The target to use for the ViewWatcher. It can be a string offset\n   * specification.\n   * See {@link Watchers/ViewWatcher.OnViewOptions | OnViewOptions}\n   *\n   * @defaultValue The element on which the {@link ViewTrigger} is defined\n   */\n  target?: ViewTarget;\n\n  /**\n   * The root to pass to the {@link ViewWatcher}.\n   * See also {@link Watchers/ViewWatcher.ViewWatcherConfig | ViewWatcherConfig}\n   *\n   * @defaultValue {@link ViewWatcher} default\n   */\n  root?: Element | null;\n\n  /**\n   * The root margin to pass to the {@link ViewWatcher}.\n   * See also {@link Watchers/ViewWatcher.ViewWatcherConfig | ViewWatcherConfig}\n   *\n   * It can be either space-separated or comma-separated.\n   *\n   * @defaultValue {@link ViewWatcher} default\n   */\n  rootMargin?: string;\n\n  /**\n   * The threshold to pass to the {@link ViewWatcher}.\n   * See also {@link Watchers/ViewWatcher.ViewWatcherConfig | ViewWatcherConfig}\n   *\n   * @defaultValue {@link ViewWatcher} default\n   */\n  threshold?: number | number[];\n};\n\n// ----------\n\nconst newConfigValidator: WidgetConfigValidatorFunc<\n  Omit<ViewTriggerConfig, \"views\">\n> = (element) => {\n  return {\n    target: (key, value) =>\n      MH.isLiteralString(value) && isValidScrollOffset(value)\n        ? value\n        : ((MH.isLiteralString(value)\n            ? waitForReferenceElement(value, element)\n            : null) ?? undefined),\n    root: (key, value) =>\n      (MH.isLiteralString(value)\n        ? waitForReferenceElement(value, element)\n        : null) ?? undefined,\n    rootMargin: validateString,\n    threshold: (key, value) => validateNumList(key, value),\n  };\n};\n\nconst setupRepresentative = async (element: Element): Promise<Element> => {\n  const allowedToWrap =\n    settings.contentWrappingAllowed === true &&\n    getData(element, MC.PREFIX_NO_WRAP) === null &&\n    // Done by another animate action?\n    !MH.classList(MH.parentOf(element))?.contains(MC.PREFIX_WRAPPER);\n\n  let target: Element;\n  if (allowedToWrap) {\n    target = await wrapElement(element, { ignoreMove: true });\n    addClasses(target, MC.PREFIX_WRAPPER);\n\n    if (isInlineTag(MH.tagName(target))) {\n      addClasses(target, MC.PREFIX_INLINE_WRAPPER);\n    }\n  } else {\n    // Otherwise create a dummy hidden clone that's not animated and position\n    // it absolutely in a wrapper of size 0 that's inserted just before the\n    // actual element, so that the hidden clone overlaps the actual element's\n    // regular (pre-transformed) position.\n\n    const prev = element.previousElementSibling;\n    const prevChild = MH.childrenOf(prev)[0];\n    if (\n      prev &&\n      hasClass(prev, MC.PREFIX_WRAPPER) &&\n      prevChild &&\n      hasClass(prevChild, MC.PREFIX_GHOST)\n    ) {\n      // Done by a previous animate action?\n      target = prevChild;\n    } else {\n      target = (await insertGhostClone(element))._clone;\n    }\n  }\n\n  return target;\n};\n"],"mappings":"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","ignoreList":[]}