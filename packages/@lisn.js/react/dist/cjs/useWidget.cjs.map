{"version":3,"file":"useWidget.cjs","names":["Object","defineProperty","exports","value","useWidget","_react","require","_useDeepMemo","newWidget","config","widgetRef","elementRef","useRef","widgetRefInternal","configMemo","useDeepMemo","useEffect","current","Element","_widgetRefInternal$cu","destroy","useImperativeHandle","getWidget"],"sources":["../../src/useWidget.ts"],"sourcesContent":["\"use client\";\nimport {\n  useRef,\n  useEffect,\n  useImperativeHandle,\n  RefObject,\n  ComponentRef,\n  ElementType,\n} from \"react\";\n\nimport type { Widget } from \"lisn.js\";\nimport { WidgetComponentRef } from \"./types\";\nimport { useDeepMemo } from \"./useDeepMemo\";\n\nexport const useWidget = <\n  T extends ElementType,\n  W extends Widget,\n  C extends object,\n>(\n  newWidget: (element: Element, config?: C) => W | null,\n  config?: C,\n  widgetRef?: RefObject<WidgetComponentRef<W>>,\n) => {\n  const elementRef = useRef<ComponentRef<T>>(null);\n  const widgetRefInternal = useRef<W>(null);\n  const configMemo = useDeepMemo(config);\n\n  useEffect(() => {\n    if (elementRef.current instanceof Element) {\n      widgetRefInternal.current = newWidget(elementRef.current, configMemo);\n    }\n\n    return () => {\n      widgetRefInternal.current?.destroy();\n    };\n  }, [configMemo, newWidget]);\n\n  useImperativeHandle(widgetRef, () => {\n    return {\n      getWidget: () => widgetRefInternal.current,\n    };\n  });\n\n  return elementRef;\n};\n"],"mappings":";AAAA,YAAY;;AAACA,MAAA,CAAAC,cAAA,CAAAC,OAAA;EAAAC,KAAA;AAAA;AAAAD,OAAA,CAAAE,SAAA;AACb,IAAAC,MAAA,GAAAC,OAAA;AAWA,IAAAC,YAAA,GAAAD,OAAA;AAEO,MAAMF,SAAS,GAAGA,CAKvBI,SAAqD,EACrDC,MAAU,EACVC,SAA4C,KACzC;EACH,MAAMC,UAAU,GAAG,IAAAC,aAAM,EAAkB,IAAI,CAAC;EAChD,MAAMC,iBAAiB,GAAG,IAAAD,aAAM,EAAI,IAAI,CAAC;EACzC,MAAME,UAAU,GAAG,IAAAC,wBAAW,EAACN,MAAM,CAAC;EAEtC,IAAAO,gBAAS,EAAC,MAAM;IACd,IAAIL,UAAU,CAACM,OAAO,YAAYC,OAAO,EAAE;MACzCL,iBAAiB,CAACI,OAAO,GAAGT,SAAS,CAACG,UAAU,CAACM,OAAO,EAAEH,UAAU,CAAC;IACvE;IAEA,OAAO,MAAM;MAAA,IAAAK,qBAAA;MACX,CAAAA,qBAAA,GAAAN,iBAAiB,CAACI,OAAO,cAAAE,qBAAA,eAAzBA,qBAAA,CAA2BC,OAAO,CAAC,CAAC;IACtC,CAAC;EACH,CAAC,EAAE,CAACN,UAAU,EAAEN,SAAS,CAAC,CAAC;EAE3B,IAAAa,0BAAmB,EAACX,SAAS,EAAE,MAAM;IACnC,OAAO;MACLY,SAAS,EAAEA,CAAA,KAAMT,iBAAiB,CAACI;IACrC,CAAC;EACH,CAAC,CAAC;EAEF,OAAON,UAAU;AACnB,CAAC;AAACT,OAAA,CAAAE,SAAA,GAAAA,SAAA","ignoreList":[]}